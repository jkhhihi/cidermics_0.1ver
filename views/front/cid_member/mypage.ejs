<!DOCTYPE html>
<html lang="ko">
<head>
	
<!-- 네이버 -->
<meta name="naver-site-verification" content="083657cb98aa9a4a9c62dedeffddfb2490545da0"/>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1"-->
<title>마이페이지</title>
<link href="/css/cid_member.css" rel="stylesheet">
<style type="text/css">
body { padding-right: 0px !important }
.but-area{text-align:center; padding:5px 20px;}
.btn{padding: 15px 20px !important;}
</style>
<body style="overflow:scroll;">

<% include ../top %>

<div class="mypage">
<div class="profile" align="center" style="height:auto; padding:20px 0 10px 0; background-color:#ececec;">
	<div class="picture"><img src="<%=mypage[0].mem_profile%>"><!--img src="/page_imgs/fixed_img/profile-basic-pic.svg"--></div>
	<div class="mem-name">
		<span><%=mypage[0].mem_name%>(<%=mypage[0].mem_nick%>)</span>
		<span data-toggle="modal" data-target="#myModal" class="btn-request"><img style="display:inline-block; width:55px;" src="/page_imgs/fixed_img/setting-icon.svg"><span>회원정보수정</span></span>
		<!--a href="#"><img style="display:inline-block; width:15px;" src="/page_imgs/fixed_img/setting-icon.svg"></a-->
	</div>
</div>
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document"style="width:300px;">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h5 class="modal-title" id="myModalLabel" style="font-weight:bold;">회원정보 수정</h5>
      </div>
      <!--form action="/discuss/ask" method="post"-->
      <form id='formMeg'>
      <div class="modal-body">
          <div class="form-group">
            <label for="writer-name" class="control-label">성명</label>
            <input type="text" class="form-control3" id="mem_name" name="mem_name" value="<%=mypage[0].mem_name%>">
          </div>
          <div class="form-group">
            <label for="title" class="control-label">닉네임</label>
            <input type="text" class="form-control3" id="mem_nick" name="mem_nick" value="<%=mypage[0].mem_nick%>">
          </div>
          <div class="form-group">
            <label for="messageText" class="control-label">내용</label>
            <textarea class="form-control4" id="messageText" name="text" style="resize:none;"></textarea>
          </div>

      </div>


      <div class="modal-footer">
        <button type="button" class="btn1 btn-default" data-dismiss="modal">닫기</button>
        <button type="submit" class="btn1 btn-primary">보내기</button>
      </div>
      </form>
    </div>
  </div>
</div>
<!-- Modal 끝 -->

<!--프로필 이미지 설정 -->
<p>프로필 이미지 바꾸깅 </p>


<form action="" enctype="multipart/form-data" method="post" id="upload-image-form">
	 <div id="image-preview-div" style="display: none">
            <label for="exampleInputFile">Selected image:</label>
            <br>
            <img id="preview-img" src="noimage" width="100" height="100">
     </div>
    <input type="file" name="upload" id="file" required>
    <button class="btn btn-lg btn-primary" id="upload-button" type="submit" disabled>Upload image</button>
</form>
<div id="message"></div>
<div class="alert alert-info" id="loading" style="display: none;" role="alert">
	Uploading image...
	<div class="progress">
		<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
		</div>
	</div>
</div>
<div id="message"></div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<!-- 프로필 이미지 설정 -->

<script type="text/javascript">
function noPreview() {
  $('#image-preview-div').css("display", "none");
  $('#preview-img').attr('src', 'noimage');
  $('upload-button').attr('disabled', '');
}

function selectImage(e) {
  $('#file').css("color", "green");
  $('#image-preview-div').css("display", "block");
  $('#preview-img').attr('src', e.target.result);
  $('#preview-img').css('max-width', '550px');
}

$(document).ready(function (e) {


  var maxsize = 200 * 200; // 500 KB
  $('#max-size').html((maxsize/1024).toFixed(2));

    


  $('#upload-image-form').on('submit', function(e) {

    e.preventDefault();

    $('#message').empty();
    $('#loading').show();

    console.log('mem_id');

    $.ajax({
      url: "mypage/upload/",
      type: "POST",
      data: new FormData(this),
      contentType: false,
      cache: false,
      processData: false,
      success: function(data)
      {
        $('#loading').hide();
        alert(data);
        location.reload();
        //refresh;
        //$('#message').html();
      }
  });
});

  $('#file').change(function() {

  	    	

    $('#message').empty();

    var file = this.files[0];

    var match = ["image/jpeg", "image/png", "image/jpg"];
    if ( !( (file.type == match[0]) || (file.type == match[1]) || (file.type == match[2]) ) )
    {
      noPreview();

      $('#message').html('<div class="alert alert-warning" role="alert">JPG, JPEG, PNG만 허용됩니다.</div>');

      return false;
    }
    if ( file.size > maxsize )
    {
      noPreview();

      $('#message').html('<div class=\"alert alert-danger\" role=\"alert\">선택하신 이미지 사이즈: ' + (file.size/1024).toFixed(2) + ' KB, 크기 제한 :' + (maxsize/1024).toFixed(2) + ' KB 200 X 200 px (권장) </div>');

      return false;
    }

    $('#upload-button').removeAttr("disabled");

    var reader = new FileReader();
    reader.onload = selectImage;
    reader.readAsDataURL(this.files[0]);

  });

});

</script>

<script type="text/javascript">

//AJAX로 서브밋한 후에 메세지 넘기기 

  $(function () {

   $('#formMeg').on('submit', function (e) {

   	e.preventDefault();

	$.ajax({
 	url: 'mypage/update/',
 	type: "POST",
	//data: JSON.stringify(data),
	data: $('#formMeg').serialize(),
	success: function(response){
  	alert('주제 요청 등록이 완료되었습니다. 소중한 의견 감사합니다.');
  	//window.location.href="/discuss";
 	}
	});
   });
  });
</script>

<div class="container" align="center">
	<span class="enjoy-con-title">즐겨찾는 콘텐츠</span>
	<!-- 즐겨찾기한 콘텐츠 뿌림 -->
	<div class="con-in row" align="center">
			<% for(var i=0; i < clip.length; i++) { %>
			<div class="col-md-6 col-xs-4">
				<div class="thumnail">
					<a href="/contents/detail/<%= clip[i].con_no %>">
					<div class="con-img">
						<div class="con-thumbnail"><img class="img-responsive" src="<%= clip[i].con_photo %>"></div>
					</div>
					<div class="con-title"><%= clip[i].con_title %></div>
					</a>
				</div>			
			</div>
			<% } %>

		</div>
	<!-- 콘텐츠 뿌림 끝 -->
	
	<p class="con-plus">+ 더보기</p>
</div>
</div>

	<script src="/js/swiper.js"></script>
	<script>
    var swiper = new Swiper('.swiper-container', {
        pagination: '.swiper-pagination',
        slidesPerView: 3,
        paginationClickable: true,
        spaceBetween: 2,
        freeMode: true
        
    });
    </script>

<% include ../bottom %>
</body>
</html>
